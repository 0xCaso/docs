
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>Delegation (AAVE) Â· 1delta docs</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 4.0.7">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="abstract-accounts.html" />
    
    
    <link rel="prev" href="overview.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../margin-aggregation.html">
            
                <a href="../margin-aggregation.html">
            
                    
                    Margin Aggregation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="overview.html">
            
                <a href="overview.html">
            
                    
                    Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.3.1" data-path="delegation.html">
            
                <a href="delegation.html">
            
                    
                    Delegation (AAVE)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="abstract-accounts.html">
            
                <a href="abstract-accounts.html">
            
                    
                    Abstract Accounts (0VIX)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../architecture/overview.html">
            
                <a href="../architecture/overview.html">
            
                    
                    Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../architecture/delegation.html">
            
                <a href="../architecture/delegation.html">
            
                    
                    Delegation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../architecture/abstract-account.html">
            
                <a href="../architecture/abstract-account.html">
            
                    
                    Abstract Accounts
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../api/summary.html">
            
                <a href="../api/summary.html">
            
                    
                    Contract API
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../api/money-market.html">
            
                <a href="../api/money-market.html">
            
                    
                    Money Market
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../api/borrow-swap.html">
            
                <a href="../api/borrow-swap.html">
            
                    
                    Borrow Swap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../api/collateral-swap.html">
            
                <a href="../api/collateral-swap.html">
            
                    
                    Collateral Swap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../api/margin-open.html">
            
                <a href="../api/margin-open.html">
            
                    
                    Open Margin Position
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../api/margin-close.html">
            
                <a href="../api/margin-close.html">
            
                    
                    Close Margin Position
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Delegation (AAVE)</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <html><head></head><body><h1 id="how-to-use-1deltas-margin-aggregator"><a name="how-to-use-1deltas-margin-aggregator" class="plugin-anchor" href="#how-to-use-1deltas-margin-aggregator"><i class="fa fa-link" aria-hidden="true"></i></a>How to use 1delta&apos;s margin aggregator</h1>
<p>In this guide, we will outline the process of utilizing the 1delta margin trading implementation to manage lending positions within the AAVE lending protocol.</p>
<h2 id="supply--withdraw--borrow--repay"><a name="supply--withdraw--borrow--repay" class="plugin-anchor" href="#supply--withdraw--borrow--repay"><i class="fa fa-link" aria-hidden="true"></i></a>Supply / Withdraw / Borrow / Repay</h2>
<p>To begin, we first select a trade type by clicking the &quot;Start Trading&quot; button, followed by choosing the specific position we wish to engage with.</p>
<p>The screenshot below illustrates a selection of WETH as collateral, indicating that we intend to interact with a WETH collateral position.</p>
<p><img src="../assets/delegation/select-single.png" alt="Select" title="Pick the trade!"> 
<em>Selecting a single asset on the collateral side allows us to either withdraw or deposit to the lender.</em></p>
<p>By clicking on the prominent blue button, we can now link a swap trade to either a deposit or withdrawal transaction. However, it&apos;s essential to deposit collateral first before proceeding with any other transaction types that include borrowing.</p>
<p><img src="../assets/delegation/swap-in.png" alt="Transact In" title="Supply collateral!"> 
<em>On the left hand side, a direct supply is initiated, on the right hand side, a swap from USDC to WETH is done before supplying the obtained WETH.</em></p>
<p>To initiate a withdrawal, click on &quot;Withdraw instead&quot; or the arrow situated between the input panels.</p>
<p>In order to borrow or repay funds, select a single currency on the debt side. The default mode is set to borrowing; however, by clicking on &quot;Repay instead,&quot; we can opt to repay debt using our wallet balance.</p>
<h2 id="open-a-margin-position"><a name="open-a-margin-position" class="plugin-anchor" href="#open-a-margin-position"><i class="fa fa-link" aria-hidden="true"></i></a>Open a margin position</h2>
<p>With collateral in place, we can now proceed to open a margin position by selecting one currency for collateral and another for debt. The example below demonstrates our selection for building a long WETH position funded by borrowing USDC. To execute the trade, we click the trade button once more.
<img src="../assets/delegation/select-margin-open.png" alt="Open Margin" title="Open a margin position!"> 
<em>Choose a single currency for both collateral and debt sides, then click the trade button to configure the margin trade.</em></p>
<p>The swap modal presents an overview of the trade details. We can either specify the amount of WETH we wish to deposit or the amount of USDC we want to borrow. First, we must approve the borrow delegation, which grants permission for the 1delta router to borrow funds on our behalf. Additionally, we can choose between different borrowing modes when trading on top of AAVE.</p>
<p><img src="../assets/delegation/margin-open.png" alt="Open Margin Modal" title="Trade!"> 
<em>The swap modal displays the trade&apos;s impact on our health factor and LTV.</em></p>
<p>Upon successful execution of the trade, our positions will be displayed:</p>
<p><img src="../assets/delegation/position.png" alt="Positions"> 
<em>After execution, our debt position in the selected interest rate mode and an increased WETH position will be visible.</em></p>
<h2 id="swap-debt"><a name="swap-debt" class="plugin-anchor" href="#swap-debt"><i class="fa fa-link" aria-hidden="true"></i></a>Swap debt</h2>
<p>With 1delta, we can effortlessly exchange our debt positions in just a single click. To swap our USDC debt for another currency, we simply select USDC and the target currency (in this case, WBTC) to access the debt swap trade configuration.</p>
<p><img src="../assets/delegation/select-debt-swap.png" alt="Positions"> 
<em>We initiate the debt swap configuration by choosing two debt currencies.</em></p>
<p>Within the trade configuration, we approve the borrow delegation (if not already done) to enable borrowing of WBTC. When selecting the maximum amount, 1delta&apos;s smart contracts ensure no residual debt remains in the position to be repaid. If the positions are in the wrong order, we can click the arrow between the input panels to switch them.</p>
<p><img src="../assets/delegation/debt-swap.png" alt="Trade Debt"> 
<em>To switch the currencies in the swap, we can click the down arrow - we would then borrow USDC and repay potential WBTC debt.</em></p>
<p>Following the trade, we&apos;ll notice that the original USDC debt position has been completely replaced with a WBTC debt position.</p>
<p><img src="../assets/delegation/post-debt-swap.png" alt="Trade Debt"> 
<em>After executing a debt swap with the maximum repay amount selected, no leftover debt will persist.</em></p>
<h2 id="swap-collateral"><a name="swap-collateral" class="plugin-anchor" href="#swap-collateral"><i class="fa fa-link" aria-hidden="true"></i></a>Swap collateral</h2>
<p>One of 1delta&apos;s key features is the ability to trade collateral without the need to withdraw and repay debt. By selecting two collateral positions, we can easily swap them. In this example, we aim to exchange our WETH collateral for USDC collateral.</p>
<p><img src="../assets/delegation/select-collateral-swap.png" alt="Trade Collateral"> 
<em>We choose two collateral positions to execute a collateral swap.</em></p>
<p>Upon pressing the trade button, we&apos;ll access the configuration. By selecting all available WETH to swap, our entire WETH collateral position will be converted to a USDC collateral position:</p>
<p><img src="../assets/delegation/collateral-swap.png" alt="Collateral Sawp Config"> 
<em>The input panel headers indicate which lending protocol interaction occurs for each position - in a collateral swap, the top currency is withdrawn to repay the bottom one.</em></p>
<p>After approving the withdrawal and executing the transaction, we&apos;ll see that our entire collateral position has been exchanged:</p>
<p><img src="../assets/delegation/post-collateral-swap.png" alt="Collateral Sawp Config"> 
<em>Post-execution view of the transaction shown in the previous screenshot.</em></p>
<h2 id="close-a-margin-position"><a name="close-a-margin-position" class="plugin-anchor" href="#close-a-margin-position"><i class="fa fa-link" aria-hidden="true"></i></a>Close a margin position</h2>
<p>In the event that our health factor drops rapidly, we can prevent liquidation with just a single click. 1delta enables us to directly withdraw, swap, and repay a loan in one simple step. In this case, similar to opening a margin position, we&apos;ll need to select one currency on the collateral side (the currency we want to withdraw) and another on the debt side (the currency we want to repay).</p>
<p>Upon clicking the trade button, either click on the arrow or the &quot;Close position instead&quot; button to reduce our position. We&apos;ll need to approve the 1Delta contract&apos;s withdrawal of collateral on our behalf, as demonstrated in the following screenshot.</p>
<p><img src="../assets/delegation/margin-trim.png" alt="Trim Margin"> 
<em>Approval of withdrawal is required before closing our position.</em></p>
<p>After executing the trade, we&apos;ll notice that no debt position remains.</p>
<p><img src="../assets/delegation/post-margin-trim.png" alt="Trim Margin Post"> 
<em>When selecting the maximum amount, no residual debt will persist in the position</em></p>
<p>Subsequently, we can withdraw all our collateral as described in the initial step.</p>
<h2 id="conclsion"><a name="conclsion" class="plugin-anchor" href="#conclsion"><i class="fa fa-link" aria-hidden="true"></i></a>Conclsion</h2>
<p>By following the steps outlined in this guide, you have successfully opened an approximately 3x leveraged long position in WETH, switched the exposure to short BTC, and closed the entire position. It&apos;s important to note that all actions demonstrated above can be executed in any order and using multiple currencies for both the collateral and debt sides.</p>
</body></html>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="overview.html" class="navigation navigation-prev " aria-label="Previous page: Guide">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="abstract-accounts.html" class="navigation navigation-next " aria-label="Next page: Abstract Accounts (0VIX)">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Delegation (AAVE)","level":"1.3.1","depth":2,"next":{"title":"Abstract Accounts (0VIX)","level":"1.3.2","depth":2,"path":"guide/abstract-accounts.md","ref":"./guide/abstract-accounts.md","articles":[]},"previous":{"title":"Guide","level":"1.3","depth":1,"path":"guide/overview.md","ref":"./guide/overview.md","articles":[{"title":"Delegation (AAVE)","level":"1.3.1","depth":2,"path":"guide/delegation.md","ref":"./guide/delegation.md","articles":[]},{"title":"Abstract Accounts (0VIX)","level":"1.3.2","depth":2,"path":"guide/abstract-accounts.md","ref":"./guide/abstract-accounts.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["-lunr","page-toc-button","include-codeblock","anchors","js-console","livereload"],"root":".","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"livereload":{},"search":{},"fontsettings":{"theme":"white","family":"sans","size":2},"js-console":{},"highlight":{},"page-toc-button":{"maxTocDepth":2,"minTocSize":2},"include-codeblock":{"check":false,"edit":false,"lang":"","fixlang":false,"template":"./resources/gitbook-plugin-include-codeblock.hbs","theme":"chrome","unindent":false},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"esversion":"2019","nodeversion":"12.13.0","npmversion":"6.12.0","triplebackticks":"```","console":"<a class=\"gitbook-plugin-js-console\" aria-hidden=\"true\"></a>"},"title":"1delta docs","gitbook":">=3.0.0"},"file":{"path":"guide/delegation.md","mtime":"2023-04-11T10:58:15.601Z","type":"markdown"},"gitbook":{"version":"4.0.7","time":"2023-04-11T10:59:32.380Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-page-toc-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-js-console/console-ui.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

